<!-- å·¦è¾¹ç»Ÿè®¡ -->


<div class=" layui-col-md8">
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md6">
            <div class="layui-card fold-card export">
                <div class="layui-card-header">ä¸šåŠ¡è¯¢ç›˜æ’è¡Œ</div>
                <div class="filter-bar">
                    <label>å›¢é˜Ÿç­›é€‰ï¼š</label>
                    <select id="yw_team_filter" lay-filter="yw_team_filter" class="layui-select" style="width: 150px; margin-right: 15px;">
                        <option value="">å…¨éƒ¨å›¢é˜Ÿ</option>
                        {volist name="$data['yw_data']['total']" id='vo'}
                        <option value="{$vo['team_name']}">{$vo['team_name']}</option>
                        {/volist}
                    </select>
                    <div class="total">åˆè®¡ï¼š<span>{$data['yw_data']['list']|array_column='yw_num'|array_sum}</span></div>
                </div>
                <div class="layui-card-body table-scroll">
                    <table id="yw_list_table" class="layui-table layui-table-sm fold-table">
                        <thead>
                            <tr>
                                <th>ä¸šåŠ¡å‘˜</th>
                                <th>è¯¢ç›˜æ•°é‡</th>
                            </tr>
                        </thead>
                        <tbody>
                            {volist name="$data['yw_data']['list']" id='vo'}
                            <tr>
                                <td><b>{$vo['username']}</b> ({$vo['team_name']})</td>
                                <td>{$vo['yw_num']}</td>
                            </tr>
                            {/volist}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="layui-col-md6">
            <div class="layui-card export">
                <div class="layui-card-header">ä¸šåŠ¡è¯¢ç›˜æ±‡æ€»</div>
                <div class="filter-bar">
                       <div><a href="javascript:void(0);" class="detail-link" data-url="{:url('getDetail')}" data-type="yw-total">æŸ¥çœ‹è¯¦æƒ…</a></div>
                      <div class="total">åˆè®¡ï¼š<span>{$data['yw_data']['total']|array_column='yw_num'|array_sum}</span></div>
                </div>
                <div class="layui-card-body">
                    <table id="yw_total_table" class="layui-table layui-table-sm">
                        <thead>
                            <tr>
                                <th>å›¢é˜Ÿ</th>
                                <th>è¯¢ç›˜æ•°é‡</th>
                            </tr>
                        </thead>
                        <tbody>
                            {volist name="$data['yw_data']['total']" id='vo' key="k" }
                            <tr>
                                <td><span style="font-weight: 600;">{$vo['team_name']}</span> </td>
                                <td>{$vo['yw_num']}</td>
                            </tr>
                            {/volist}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md6">

            <div class="layui-card fold-card export">
                <div class="layui-card-header">è¿è¥è¯¢ç›˜æ’è¡Œ</div>
                <div class="filter-bar">
                    <label>å›¢é˜Ÿç­›é€‰ï¼š</label>
                    <select id="yy_team_filter" lay-filter="yy_team_filter" class="layui-select" style="width: 150px; margin-right: 15px;">
                        <option value="">å…¨éƒ¨å›¢é˜Ÿ</option>
                        {volist name="$data['yy_data']['total']" id='vo'}
                        <option value="{$vo['channel']}">{$vo['channel']}</option>
                        {/volist}
                    </select>
                    <div class="total">åˆè®¡ï¼š<span>{$data['yy_data']['list']|array_column='yy_num'|array_sum}</span></div>
                </div>
                <div class="layui-card-body table-scroll">
                    <table id="yy_list_table" class="layui-table layui-table-sm fold-table">
                        <thead>
                            <tr>
                                <th>è¿è¥</th>
                                <th>è¯¢ç›˜æ•°é‡</th>
                            </tr>
                        </thead>
                        <tbody>
                            {volist name="$data['yy_data']['list']" id='vo'}
                            <tr>
                                <td><b>{$vo['username']}</b> ({$vo['channel']})</td>
                                <td>{$vo['yy_num']}</td>
                            </tr>
                            {/volist}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="layui-col-md6">
            <div class="layui-card export">
                <div class="layui-card-header">è¿è¥è¯¢ç›˜æ±‡æ€»</div>
                <div class="filter-bar">
                    <div class="total">åˆè®¡ï¼š<span>{$data['yy_data']['total']|array_column='yy_num'|array_sum}</span></div>
                </div>
                <div class="layui-card-body">
                    <table id="yy_total_table" class="layui-table layui-table-sm">

                        <thead>
                            <tr>
                                <th>å›¢é˜Ÿ</th>
                                <th>è¯¢ç›˜æ•°é‡</th>
                            </tr>
                        </thead>
                        <tbody>
                            {volist name="$data['yy_data']['total']" id='vo'}
                            <tr>
                                <td><b>{$vo['channel']}</b></td>
                                <td>{$vo['yy_num']}</td>
                            </tr>
                            {/volist}
                        </tbody>
                    </table>
                </div>
            </div>

        </div>
    </div>
    <div class="layui-row layui-col-space15">
        <div class="layui-col-md6">
            <div class="layui-card export">

                <div class="layui-card-header">é”€å”®äº§å“æ’è¡Œ</div>
                <div class="layui-card-body">
                    <table id="sp_list_table" class="layui-table layui-table-sm" data-url="getProdAll" data-params='{"data":{"type":"order"},"ele":["#at_time","#dateRange"]}'>

                        <thead>
                            <tr>
                                <th>äº§å“</th>
                                <th>é”€å”®æ•°é‡</th>
                            </tr>
                        </thead>
                        <tbody>
                            {volist name="$data['product_data']['order_prod']" id='vo'}
                            <tr>
                                <td>{$vo['product_name']}</td>
                                <td>{$vo['count']}</td>
                            </tr>
                            {/volist}
                            {if !$data['product_data']['order_prod']}<tr>
                                <td colspan="2">æš‚æ— æ•°æ®</td>
                            </tr>{/if}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <div class="layui-col-md6">
            <div class="layui-card export" >

                <div class="layui-card-header">è¯¢ç›˜äº§å“æ’è¡Œ</div>
                <div class="layui-card-body">
                    <table id="pd_list_table" class="layui-table layui-table-sm" data-url="getProdAll" data-params='{"data":{"type":"oper"},"ele":["#at_time","#dateRange"]}' >
                        <thead>
                            <tr>
                                <th>äº§å“</th>
                                <th>è¯¢ç›˜æ•°é‡</th>
                            </tr>
                        </thead>
                        <tbody>

                            {volist name="$data['product_data']['oper_prod']" id='vo'}
                            <tr>
                                <td>{$vo['product_name']}</td>
                                <td>{$vo['count']}</td>
                            </tr>
                            {/volist}
                            {if !$data['product_data']['oper_prod']}<tr>
                                <td colspan="2">æš‚æ— æ•°æ®</td>
                            </tr>{/if}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- å³è¾¹å¾…åŠ + åŠ¨æ€ -->
<div class="layui-col-md4">
    <div class="layui-card">
        <div class="layui-card-header">{$wenhou}</div>
        <div class="layui-card-body layui-text">
            æ¬¢è¿å›æ¥ï¼ç¥ä½ å·¥ä½œé¡ºåˆ© ğŸ‘
        </div>
    </div>

    <div class="layui-card">
        <div class="layui-card-header">å¾…åŠäº‹é¡¹</div>
        <div class="layui-card-body">
            <table class="layui-table layui-table-sm">
                <tbody>
                    <tr>
                        <td>ä»Šæ—¥å·²è·Ÿè¿›</td>
                        <td>{$today_count}</td>
                    </tr>
                    <tr>
                        <td>æœªè·Ÿè¿›ä¸ªæ•°</td>
                        <td>{$all_count}</td>
                    </tr>
                    <tr>
                        <td>è·Ÿè¿›ç‡</td>
                        <td>{$genjinlv}%</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="layui-card">
        <div class="layui-card-header">æœ€è¿‘åŠ¨æ€</div>
        <div class="layui-card-body">
            <dl class="layuiadmin-card-status">
                {volist name='result' id='vo'}
                <dd>
                    <div class="layui-status-img">
                        <a><img src="{$vo.avatar}" style="border-radius:50%"></a>
                    </div>
                    <div>
                        <p>{$vo.username} <em style="color:red;">è·Ÿè¿›</em>
                            <a href="{:url('Client/dialogue')}?id={$vo.id}"> {$vo.kh_name}</a>
                        </p>
                        <p class="msg"><b style="color: burlywood;">è®°å½•:</b> {$vo.reply_msg}</p>
                        <span>æ—¶é—´ï¼š{$vo.create_date|date='Y-m-d H:i:s'}</span>
                    </div>
                </dd>
                {/volist}
            </dl>
        </div>
    </div>
</div>

<!-- è¯¦æƒ…å¼¹çª— -->
<div id="detailModal" style="display: none; padding: 20px;">
    <div class="layui-row">
        <div class="layui-col-md12">
            <div class="layui-card">
                <div class="layui-card-header">
                    <span id="modalTitle">äº¤å‰ç»Ÿè®¡è¡¨</span>
                    <button style="float: right;" class="layui-btn layui-btn-sm" onclick="exportCrossTable()">å¯¼å‡ºè¡¨æ ¼</button>
                </div>
                <div class="layui-card-body">
                    <div id="crossTableContainer" style="overflow-x: auto;">
                        <!-- è¡¨æ ¼å°†åœ¨è¿™é‡ŒåŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<script>
    function initFoldCard() {
        $('.fold-card').each(function () {
            var $card = $(this);
            var $header = $card.find('.layui-card-header');
            var $scroll = $card.find('.table-scroll');
            if ($scroll.length && $scroll[0].scrollHeight > $scroll.height() + 20) {
                if ($header.find('.toggle-table').length === 0) {
                    $header.append('<button class="layui-btn layui-btn-xs toggle-table">å±•å¼€</button>');
                }
            } else {
                $header.find('.toggle-table').remove();
            }
        });
    }
    // é¡µé¢åˆå§‹åŒ–æ—¶è¿è¡Œä¸€æ¬¡
    $(document).ready(init);

    function init(){
        initFoldCard();
         ExportSelectTables.addCheckboxes();
    }
</script>